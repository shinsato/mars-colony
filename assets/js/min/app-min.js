!function(t,i){"use strict";t.module("app",["ngDraggable"]).controller("appController",["$scope","$interval",function(t,o){t.totalCount=0,t.activity=["nothing","farming","mining"];var e=function(){this.gender=chance.gender(),this.name=chance.name({gender:this.gender}),this.age=i.random(15,30),this.charisma={},buildOut(this.charisma),this.strength={},buildOut(this.strength),this.intelligence={},buildOut(this.intelligence),this.endurance={},buildOut(this.endurance),this.uid=this.charisma.gene.concat(this.endurance.gene,this.strength.gene,this.intelligence.gene),this.activity="nothing",this.alive=!0,this.withChild=!1,this.room=0,t.totalCount++};e.prototype.Age=function(){if(!this.alive)return!1;if(this.withChild>0&&this.withChild++,"Female"==this.gender){if(this.withChild>=3){this.withChild=!1;var o=new e;o.id=t.colony.colonists.length,o.age=0,t.colony.colonists.push(o)}if(this.IsFertile()&&"farming"===!this.activity){console.log("trying",this.activity);for(var n in t.colony.colonists){var s=t.colony.colonists[n];if(this.id!=s.id&&this.room>=1&&this.room<=10&&this.room==s.room&&this.IsFertile()&&"Male"==s.gender&&"nothing"===s.activty){var a=i.random(1,6);console.log("Roll to conceive");var l=a+this.charisma.attr+s.charisma.attr;if(l>=4){this.withChild=1,console.log("With child!");break}}}}}this.age++,this.RollEndurance(),this.endurance.attr<1&&(this.alive=!1,t.totalCount--)},e.prototype.RollEndurance=function(){var t=i.random(1,10);this.age<=2||this.age>=75?t-=2:(this.age<=5||this.age>=65)&&(t-=1),1>=t&&this.endurance.attr--},e.prototype.RollStrength=function(){var t=i.random(1,10);return t+(this.endurance.attr-5)},e.prototype.IsFertile=function(){return this.alive&&this.age>=18&&0==this.withChild?"Female"==this.gender&&this.age>=51?!1:!0:!1};var n=function(t,i){i=i||6,this.starterCount=i,this.name=t,this.age=0,this.alive=!0,this.colonists=[],this.couples=[],this.food=7*i,this.ore=0;for(var o=1;i>=o;o++){var n=new e;n.id=this.colonists.length,this.colonists.push(n)}};n.prototype.Age=function(){var t=!1,i=this;this.age++,this.food--;for(var o in this.colonists){if(this.colonists[o].Age(),this.colonists[o].alive&&(t=!0),"farming"===this.colonists[o].activity){var e=this.colonists[o].RollStrength();e>5&&i.food++,console.log("Food Fired",e)}if("mining"===this.colonists[o].activity){console.log("Mining!");var n=this.colonists[o].RollStrength();n>7?(i.ore++,console.log("mining success!")):n>=2?(this.endurance--,console.log("R'uh r'oh.")):0===n&&(this.alive=!1,console.log("NOOOOOOOO."))}}this.alive=t},t.onDragSucces=function(i,o,e){var n=t.draggableObjects[i],s=t.draggableObjects.indexOf(o);t.draggableObjects[i]=o,t.draggableObjects[s]=n},t.game={theLoop:!1,started:!1,colonyStarted:!1,colonyName:"OMG Why?",numColonists:6},t.beginColony=function(){t.colony=new n(t.game.colonyName,t.game.numColonists),t.game.started=!0,t.game.colonyStarted=!0,t.startColony()},t.startColony=function(){t.game.theLoop=o(function(){t.colony.Age(),t.colony.alive||(t.game.colonyStarted=!1,t.stopColony())},1e3)},t.stopColony=function(){o.cancel(t.game.theLoop),t.game.theLoop=!1},t.togglePause=function(){t.game.colonyStarted&&(t.game.theLoop!==!1?t.stopColony():t.startColony())}}]).controller("manageCrew",["$scope",function(t){}]).directive("pressSpace",function(){return function(t,i,o){i.bind("keydown keypress",function(i){32===i.which&&(t.$apply(function(){t.$eval(o.pressSpace)}),i.preventDefault())})}})}(window.angular,window._);